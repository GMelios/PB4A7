<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dr.&nbsp;George Melios">
<meta name="dcterms.date" content="18 October 2024">

<title>PB4A7 - Quantitative Applications for Behavioural Science - Controls</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../figures/icons/course_favicon.png" rel="icon" type="image/png">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../../css/custom_style.css">
<link rel="stylesheet" href="../../../css/syllabus.css">
<meta property="og:title" content="PB4A7 - Quantitative Applications for Behavioural Science - Controls">
<meta property="og:description" content="Telling endogeneity we‚Äôve had ENOUGH">
<meta property="og:image" content="slides_files/figure-html/unnamed-chunk-7-1.gif">
<meta property="og:site-name" content="PB4A7 - Quantitative Applications for Behavioural Science">
<meta name="twitter:title" content="PB4A7 - Quantitative Applications for Behavioural Science - Controls">
<meta name="twitter:description" content="Telling endogeneity we‚Äôve had ENOUGH">
<meta name="twitter:image" content="slides_files/figure-html/unnamed-chunk-7-1.gif">
<meta name="twitter:creator" content="@georgemelios">
<meta name="twitter:site" content="\www.georgemelios.com">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">PB4A7 - Quantitative Applications for Behavioural Science</span>
    </a>
  </div>
        <div class="quarto-navbar-tools ms-auto">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Controls</li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2024/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üè† Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2024/syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üìì Syllabus</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2024/Stata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">STATA resources</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2024/R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R &amp; Python resources</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">üóìÔ∏è Weeks</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../2024/weeks/week00/page.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Presessionals</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2024/weeks/week00/page.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../2024/weeks/week01/page.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 01</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2024/weeks/week01/page.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üë®‚Äçüè´ Lecture Material</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2024/weeks/week01/page1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üíª Seminar Material</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../2024/weeks/week02/page.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 02</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2024/weeks/week02/page.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üë®‚Äçüè´ Lecture Material</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2024/weeks/week02/page1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üíª Seminar Material</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../2024/weeks/week03/page.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 03</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2024/weeks/week03/page.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üë®‚Äçüè´ Lecture Material</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2024/weeks/week03/page1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üíª Seminar Material</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../2024/weeks/week04/page.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 04</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2024/weeks/week04/page.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üë®‚Äçüè´ Lecture Material</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2024/weeks/week04/page1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üíª Seminar Material</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../2024/weeks/week05/page.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 05</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2024/weeks/week05/page.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üë®‚Äçüè´ Lecture Material</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2024/weeks/week05/page1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üíª Seminar Material</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../2024/weeks/week06/page.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 06</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2024/weeks/week06/page.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üë®‚Äçüè´ Lecture Material</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2024/weeks/week06/page1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üíª Seminar Material</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../2024/weeks/week07/page.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 07</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2024/weeks/week07/page.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üë®‚Äçüè´ Lecture Material</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2024/weeks/week07/page1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üíª Seminar Material</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../2024/weeks/week08/page.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 08</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2024/weeks/week08/page.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üë®‚Äçüè´ Lecture Material</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2024/weeks/week08/page1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üíª Seminar Material</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../2024/weeks/week09/page.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 09</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2024/weeks/week09/page.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üë®‚Äçüè´ Lecture Material</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2024/weeks/week09/page1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üíª Seminar Material</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../2024/weeks/week10/page.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 10</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2024/weeks/week10/page.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üë®‚Äçüè´ Lecture Material</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2024/weeks/week10/page1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üíª Seminar Material</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../2024/weeks/week11/page.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 11</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2024/weeks/week12/page.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üë®‚Äçüè´ Lecture Material</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2024/weeks/week11/page1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üíª Seminar Material</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../../2024/weeks/week12/page.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Guest Lecture</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../2024/weeks/week12/page.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">üë®‚Äçüè´ Lecture Material</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">What we will cover today:</h2>
   
  <ul>
  <li><a href="#linear-regression---endogeneity" id="toc-linear-regression---endogeneity" class="nav-link active" data-scroll-target="#linear-regression---endogeneity">Linear Regression - Endogeneity</a></li>
  <li><a href="#recap" id="toc-recap" class="nav-link" data-scroll-target="#recap">Recap</a></li>
  <li><a href="#endogeneity-recap" id="toc-endogeneity-recap" class="nav-link" data-scroll-target="#endogeneity-recap">Endogeneity Recap</a></li>
  <li><a href="#to-the-rescue" id="toc-to-the-rescue" class="nav-link" data-scroll-target="#to-the-rescue">To the Rescue</a></li>
  <li><a href="#to-the-rescue-1" id="toc-to-the-rescue-1" class="nav-link" data-scroll-target="#to-the-rescue-1">To the Rescue</a></li>
  <li><a href="#how" id="toc-how" class="nav-link" data-scroll-target="#how">How?</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  <li><a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1">Example</a></li>
  <li><a href="#example-2" id="toc-example-2" class="nav-link" data-scroll-target="#example-2">Example</a></li>
  <li><a href="#example-3" id="toc-example-3" class="nav-link" data-scroll-target="#example-3">Example</a></li>
  <li><a href="#example-4" id="toc-example-4" class="nav-link" data-scroll-target="#example-4">Example</a></li>
  <li><a href="#graphically" id="toc-graphically" class="nav-link" data-scroll-target="#graphically">Graphically</a></li>
  <li><a href="#controlling" id="toc-controlling" class="nav-link" data-scroll-target="#controlling">Controlling</a></li>
  <li><a href="#a-continuous-control" id="toc-a-continuous-control" class="nav-link" data-scroll-target="#a-continuous-control">A Continuous Control</a></li>
  <li><a href="#what-do-we-get" id="toc-what-do-we-get" class="nav-link" data-scroll-target="#what-do-we-get">What do we get?</a></li>
  <li><a href="#concept-checks" id="toc-concept-checks" class="nav-link" data-scroll-target="#concept-checks">Concept Checks</a></li>
  <li><a href="#have-we-solved-it" id="toc-have-we-solved-it" class="nav-link" data-scroll-target="#have-we-solved-it">Have We Solved It?</a></li>
  <li><a href="#causal-diagrams" id="toc-causal-diagrams" class="nav-link" data-scroll-target="#causal-diagrams">Causal Diagrams</a></li>
  <li><a href="#drawing-a-diagram" id="toc-drawing-a-diagram" class="nav-link" data-scroll-target="#drawing-a-diagram">Drawing a Diagram</a></li>
  <li><a href="#drawing-a-diagram-1" id="toc-drawing-a-diagram-1" class="nav-link" data-scroll-target="#drawing-a-diagram-1">Drawing a Diagram</a></li>
  <li><a href="#drawing-a-diagram-2" id="toc-drawing-a-diagram-2" class="nav-link" data-scroll-target="#drawing-a-diagram-2">Drawing a Diagram</a></li>
  <li><a href="#detailing-paths" id="toc-detailing-paths" class="nav-link" data-scroll-target="#detailing-paths">Detailing Paths</a></li>
  <li><a href="#preschool-and-adult-earnings" id="toc-preschool-and-adult-earnings" class="nav-link" data-scroll-target="#preschool-and-adult-earnings">Preschool and Adult Earnings</a></li>
  <li><a href="#paths" id="toc-paths" class="nav-link" data-scroll-target="#paths">Paths</a></li>
  <li><a href="#closing-paths" id="toc-closing-paths" class="nav-link" data-scroll-target="#closing-paths">Closing Paths</a></li>
  <li><a href="#and-the-bad-news" id="toc-and-the-bad-news" class="nav-link" data-scroll-target="#and-the-bad-news">And the Bad News‚Ä¶</a></li>
  <li><a href="#and-the-bad-news-1" id="toc-and-the-bad-news-1" class="nav-link" data-scroll-target="#and-the-bad-news-1">And the Bad News‚Ä¶</a></li>
  <li><a href="#an-example" id="toc-an-example" class="nav-link" data-scroll-target="#an-example">An Example</a></li>
  <li><a href="#the-diagram" id="toc-the-diagram" class="nav-link" data-scroll-target="#the-diagram">The Diagram</a></li>
  <li><a href="#the-paths" id="toc-the-paths" class="nav-link" data-scroll-target="#the-paths">The Paths</a></li>
  <li><a href="#the-adjusted-analysis" id="toc-the-adjusted-analysis" class="nav-link" data-scroll-target="#the-adjusted-analysis">The Adjusted Analysis</a></li>
  <li><a href="#concept-checks-1" id="toc-concept-checks-1" class="nav-link" data-scroll-target="#concept-checks-1">Concept Checks</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="slides.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Controls</h1>
<p class="subtitle lead">Telling endogeneity we‚Äôve had ENOUGH</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Dr.&nbsp;<a href="#">George Melios</a> </p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="#">London School of Economics and Political Science</a>
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Updated 2024-09-25</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="linear-regression---endogeneity" class="level1">
<h1>Linear Regression - Endogeneity</h1>
<ul>
<li>Last week was all about handling sampling variation and avoiding inference error</li>
<li>This week we‚Äôre all about endogeneity!</li>
<li>Where it pops up and what we can do about it</li>
<li>At least as a starter (we‚Äôll revisit this topic many times)</li>
</ul>
<hr>
</section>
<section id="recap" class="level1">
<h1>Recap</h1>
<ul>
<li>We believe that our true model looks like this:</li>
</ul>
<p><span class="math display">\[Y = \beta_0 + \beta_1X+\varepsilon\]</span></p>
<ul>
<li>Where <span class="math inline">\(\varepsilon\)</span> is <em>everything that determines <span class="math inline">\(Y\)</span> other than <span class="math inline">\(X\)</span></em></li>
<li>If <span class="math inline">\(X\)</span> is related to some of those things, we have endogeneity</li>
<li>Estimating the above model by OLS, it will mistake the effect of those <em>other</em> things for the effect of <span class="math inline">\(X\)</span>, and our estimate of <span class="math inline">\(\hat{\beta}_1\)</span> won‚Äôt represent the true <span class="math inline">\(\beta_1\)</span> no matter how many observations we have</li>
</ul>
<hr>
</section>
<section id="endogeneity-recap" class="level1">
<h1>Endogeneity Recap</h1>
<ul>
<li>For example looking at income and corruption, the model</li>
</ul>
<p><span class="math display">\[Income = \beta_0 + \beta_1Corruption + \varepsilon\]</span></p>
<ul>
<li>The true <span class="math inline">\(\beta_1\)</span> is probably <span class="math inline">\(0\)</span>. But since <span class="math inline">\(Political Stability\)</span> is in <span class="math inline">\(\varepsilon\)</span> and <span class="math inline">\(olitical Stability\)</span> is related to <span class="math inline">\(Corruption\)</span>, OLS will mistakenly assign the effect of <span class="math inline">\(olitical Stability\)</span> to the effect of <span class="math inline">\(Corruption\)</span>, making it look like there‚Äôs a positive effect when there isn‚Äôt one</li>
<li>If <span class="math inline">\(olitical Stability\)</span> hangs around <span class="math inline">\(Corruption\)</span>, but OLS doesn‚Äôt know about it, OLS will give <span class="math inline">\(Corruption\)</span> all the credit for <span class="math inline">\(olitical Stability\)</span>‚Äôs impact on <span class="math inline">\(Income\)</span></li>
<li>Here we‚Äôre mistakenly finding a positive effect when the truth is <span class="math inline">\(0\)</span>, but it could be anything - negative effect when truth is <span class="math inline">\(0\)</span>, positive effect when the truth is a bigger/smaller positive effect, negative effect when truth is positive, etc. etc.</li>
</ul>
<hr>
</section>
<section id="to-the-rescue" class="level1">
<h1>To the Rescue</h1>
<ul>
<li>One way we can solve this problem is through the use of <em>control variables</em></li>
<li>What if <span class="math inline">\(Political Stability\)</span> <em>weren‚Äôt</em> in <span class="math inline">\(\varepsilon\)</span>? Then we‚Äôd be fine! OLS would know how to separate out its effect from the <span class="math inline">\(Corruption\)</span> effect. How do we take it out? Just put it in the model directly!</li>
</ul>
<p><span class="math display">\[Income = \beta_0 + \beta_1Corruption + \beta_2PoliticalStability + \varepsilon\]</span></p>
<ul>
<li>Now we have a <em>multivariate</em> regression model. Our estimate <span class="math inline">\(\hat{\beta}_1\)</span> will <em>not</em> be biased by <span class="math inline">\(Political Stability\)</span> because we‚Äôve controlled for it</li>
</ul>
<p><span style="font-size: small">(probably more accurate to say ‚Äúcovariates‚Äù or ‚Äúvariables to adjust for‚Äù than ‚Äúcontrol variables‚Äù and ‚Äúadjust for‚Äù rather than ‚Äúcontrol for‚Äù but hey what are you gonna do, ‚Äúcontrol‚Äù is standard)</span></p>
<hr>
</section>
<section id="to-the-rescue-1" class="level1">
<h1>To the Rescue</h1>
<ul>
<li>So the task of solving our endogeneity problems in estimating <span class="math inline">\(\beta_1\)</span> using <span class="math inline">\(\hat{\beta}_1\)</span> comes down to us <em>finding all the elements of <span class="math inline">\(\varepsilon\)</span> that are related to <span class="math inline">\(X\)</span> and adding them to the model</em></li>
<li>As we add them, they leave <span class="math inline">\(\varepsilon\)</span> and hopefully we end up with a version of <span class="math inline">\(\varepsilon\)</span> that is no longer related to <span class="math inline">\(X\)</span></li>
<li>If <span class="math inline">\(cov(X,\varepsilon) = 0\)</span> then we have an unbiased estimate!</li>
<li>(of course, we have no way of checking if that‚Äôs true - it‚Äôs based on what we think the data generating process looks like)</li>
</ul>
<hr>
</section>
<section id="how" class="level1">
<h1>How?</h1>
<ul>
<li>How does this actually work?</li>
<li>Controlling for a variable works by <em>removing variation in <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> that is explained by the control variable</em></li>
<li>So our estimate of <span class="math inline">\(\hat{\beta}_1\)</span> is based on <em>just the variation in <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> that is unrelated to the control variable</em></li>
<li>Any accidentally-assigning-the-value-of-PoliticalStability-to-Corruption can‚Äôt happen because we‚Äôve removed the effect of <span class="math inline">\(Political Stability\)</span> on <span class="math inline">\(Corruption\)</span> as well as the effect of <span class="math inline">\(Political Stability\)</span> on <span class="math inline">\(Income\)</span></li>
<li>We‚Äôre asking at that point, <em>holding <span class="math inline">\(Political Stability\)</span> constant</em>, i.e.&nbsp;<em>comparing two different countries with the same <span class="math inline">\(Polities\)</span> </em>, how is <span class="math inline">\(Corruption\)</span> related to <span class="math inline">\(Income\)</span>?</li>
</ul>
<hr>
</section>
<section id="example" class="level1">
<h1>Example</h1>
<p>The true effect is <span class="math inline">\(\beta_1 = 3\)</span>. Notice <span class="math inline">\(Z\)</span> is binary and is related to <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> but isn‚Äôt in the model!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>tib <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Z =</span> <span class="dv">1</span><span class="sc">*</span>(<span class="fu">rnorm</span>(<span class="dv">1000</span>) <span class="sc">&gt;</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">X =</span> Z <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Y =</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>X <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>Z <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>))</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">feols</span>(Y<span class="sc">~</span>X, <span class="at">data =</span> tib) <span class="sc">%&gt;%</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">etable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                .
Dependent Var.:                 Y
                                 
Constant        2.756*** (0.0461)
X               3.421*** (0.0383)
_______________ _________________
S.E. type                     IID
Observations                1,000
R2                        0.88897
Adj. R2                   0.88886
---
Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<hr>
</section>
<section id="example-1" class="level1">
<h1>Example</h1>
<p>To remove what part of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is explained by <span class="math inline">\(Z\)</span>, we can get the mean of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> by values of <span class="math inline">\(Z\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>tib <span class="ot">&lt;-</span> tib <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Z) <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Y_mean =</span> <span class="fu">mean</span>(Y), <span class="at">X_mean =</span> <span class="fu">mean</span>(X))</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tib)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 √ó 5
# Groups:   Z [2]
      Z       X      Y Y_mean  X_mean
  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
1     1  0.855   5.98    6.91  0.967 
2     1 -1.59   -0.226   6.91  0.967 
3     1  0.806   6.08    6.91  0.967 
4     1 -0.0302  2.94    6.91  0.967 
5     0 -0.490  -0.997   1.95 -0.0121
6     0 -0.512   0.383   1.95 -0.0121</code></pre>
</div>
</div>
<hr>
</section>
<section id="example-2" class="level1">
<h1>Example</h1>
<p>Now, <code>Y_mean</code> and <code>X_mean</code> are the mean of <code>Y</code> and <code>X</code> for the values of <code>Z</code>, i.e.&nbsp;the part of <code>Y</code> and <code>X</code> <em>explained by <code>Z</code></em>. So subtract those parts out to get <em>residuals</em> <code>Y_res</code> and <code>X_res</code>!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>tib <span class="ot">&lt;-</span> tib <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Y_res =</span> Y <span class="sc">-</span> Y_mean, <span class="at">X_res =</span> X <span class="sc">-</span> X_mean)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tib)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 √ó 7
# Groups:   Z [2]
      Z       X      Y Y_mean  X_mean  Y_res  X_res
  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1     1  0.855   5.98    6.91  0.967  -0.928 -0.113
2     1 -1.59   -0.226   6.91  0.967  -7.14  -2.55 
3     1  0.806   6.08    6.91  0.967  -0.827 -0.161
4     1 -0.0302  2.94    6.91  0.967  -3.98  -0.997
5     0 -0.490  -0.997   1.95 -0.0121 -2.95  -0.478
6     0 -0.512   0.383   1.95 -0.0121 -1.57  -0.499</code></pre>
</div>
</div>
<hr>
</section>
<section id="example-3" class="level1">
<h1>Example</h1>
<p>What do we get now?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">feols</span>(Y_res <span class="sc">~</span> X_res, <span class="at">data =</span> tib) <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">etable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                .
Dependent Var.:             Y_res
                                 
Constant        5.73e-17 (0.0319)
X_res           3.030*** (0.0319)
_______________ _________________
S.E. type                     IID
Observations                1,000
R2                        0.90060
Adj. R2                   0.90050
---
Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<hr>
</section>
<section id="example-4" class="level1">
<h1>Example</h1>
<p>Compare this to actually including <code>Z</code> as a control:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">feols</span>(Y <span class="sc">~</span> X <span class="sc">+</span> Z, <span class="at">data =</span> tib) <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">etable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                .
Dependent Var.:                 Y
                                 
Constant        1.988*** (0.0441)
X               3.030*** (0.0319)
Z               1.993*** (0.0712)
_______________ _________________
S.E. type                     IID
Observations                1,000
R2                        0.93782
Adj. R2                   0.93769
---
Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<hr>
</section>
<section id="graphically" class="level1">
<h1>Graphically</h1>
<div class="cell">
<div class="cell-output-display">
<p><img src="slides_files/figure-html/unnamed-chunk-7-1.gif" class="img-fluid"></p>
</div>
</div>
<hr>
</section>
<section id="controlling" class="level1">
<h1>Controlling</h1>
<ul>
<li>We achieve all this just by adding the variable to the OLS equation!</li>
<li>We can, of course, include more than one control, or controls that aren‚Äôt binary</li>
<li>Use OLS to predict <span class="math inline">\(X\)</span> using all the controls, then take the residual (the part not explained by the controls)</li>
<li>Use OLS to predict <span class="math inline">\(Y\)</span> using all the controls, then take the residual (the part not explained by the controls)</li>
<li>Now do OLS of just the <span class="math inline">\(Y\)</span> residuals on just the <span class="math inline">\(X\)</span> residuals</li>
</ul>
<hr>
</section>
<section id="a-continuous-control" class="level1">
<h1>A Continuous Control</h1>
<figure class="figure">
<img src="../../../2024/weeks/week04/linear_control.gif" alt="Linear controls" style="width:15em;height:15em;font-size:1em;" class="img-responsive atto_image_button_text-bottom figure-img">
</figure>
<hr>
</section>
<section id="what-do-we-get" class="level1">
<h1>What do we get?</h1>
<ul>
<li>We can remove some of the relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(\varepsilon\)</span></li>
<li>Potentially all of it, making <span class="math inline">\(\hat{\beta}_1\)</span> us an <em>unbiased</em> (i.e.&nbsp;correct on average, but sampling variation doesn‚Äôt go away!) estimate of <span class="math inline">\(\beta_1\)</span></li>
<li>Maybe we can also get some estimates of <span class="math inline">\(\beta_2\)</span>, <span class="math inline">\(\beta_3\)</span>‚Ä¶ but be careful, they‚Äôre subject to the same identification and endogeneity problems!</li>
<li>Often in econometrics we focus on getting <em>one</em> parameter, <span class="math inline">\(\hat{\beta}_1\)</span>, exactly right and don‚Äôt focus on parameters we haven‚Äôt put much effort into identifying</li>
</ul>
<hr>
</section>
<section id="concept-checks" class="level1">
<h1>Concept Checks</h1>
<ul>
<li>Selene is a huge bore at parties, but sometimes brings her girlfriend Donna who is super fun. If you regressed <span class="math inline">\(PartyFunRating\)</span> on <span class="math inline">\(SeleneWasThere\)</span> but not <span class="math inline">\(DonnaWasThere\)</span>, what would the coefficient on <span class="math inline">\(SeleneWasThere\)</span> look like and why?</li>
<li>Describe the steps necessary to estimate the effect of <span class="math inline">\(Exports\)</span> on <span class="math inline">\(GrowthRate\)</span> while controlling for <span class="math inline">\(AmountofConflict\)</span> (a continuous variable). There are three ‚Äúexplain/regress‚Äù steps and two ‚Äúsubtract‚Äù steps.</li>
<li>If we estimate the same <span class="math inline">\(\hat{\beta}_1\)</span> with or without <span class="math inline">\(Z\)</span> added as a control, does that mean we have no endogeneity problem? What <em>does</em> it mean exactly?</li>
</ul>
<hr>
</section>
<section id="have-we-solved-it" class="level1">
<h1>Have We Solved It?</h1>
<ul>
<li>Including controls for every part of (what used to be) <span class="math inline">\(\varepsilon\)</span> that is related to <span class="math inline">\(X\)</span> clears up any endogeneity problem we had with <span class="math inline">\(X\)</span></li>
<li>So‚Ä¶ when we add a control, does that do it? How do we know?</li>
<li>Inconveniently, the data alone will never tell us if we‚Äôve solved endogeniety</li>
<li>We can‚Äôt just check <span class="math inline">\(X\)</span> against the remaining <span class="math inline">\(\varepsilon\)</span> because we never <em>see</em> <span class="math inline">\(\varepsilon\)</span> - what we have left over after a regression is the real-world <em>residual</em>, not the true-model <em>error</em></li>
</ul>
<hr>
</section>
<section id="causal-diagrams" class="level1">
<h1>Causal Diagrams</h1>
<ul>
<li>‚ÄúWhat do I have to control for to solve the endogeneity problem‚Äù is an important and difficult question!</li>
<li>To answer it we need to think about the data-generating process</li>
<li>One way to do that is to draw a <em>causal diagram</em></li>
<li>A causal diagram describes the variables responsible for generating data and how they cause each other</li>
<li>Once we have written down our diagram, we‚Äôll know what we need to control for</li>
<li>(hopefully we have data on everything we need to control for! Often we don‚Äôt)</li>
</ul>
<hr>
</section>
<section id="drawing-a-diagram" class="level1">
<h1>Drawing a Diagram</h1>
<ul>
<li>Endogeneity is all about the <em>alternate reasons why</em> two variables might be related *other than the causal effect you want</li>
<li>We can represent <em>all</em> the reasons two variables are related with a diagram</li>
<li>Put down on paper how you think the world works, and where you think the data came from! This is economic modeling but with less math</li>
</ul>
<ol type="1">
<li>List out all the variables relevant to the DGP (including the ones we can‚Äôt measure or put our finger on!)</li>
<li>Draw arrows between them reflecting what causes what else</li>
<li>List all the paths from <span class="math inline">\(X\)</span> to <span class="math inline">\(Y\)</span> - these paths are reasons why <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are related!</li>
<li>Control for at least one variable on each path you <em>want to close</em> (isn‚Äôt the effect you want)</li>
</ol>
<hr>
</section>
<section id="drawing-a-diagram-1" class="level1">
<h1>Drawing a Diagram</h1>
<div class="cell">
<div class="cell-output-display">
<p><img src="slides_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<hr>
</section>
<section id="drawing-a-diagram-2" class="level1">
<h1>Drawing a Diagram</h1>
<ul>
<li>We observe that, in the data, <span class="math inline">\(ShortsWearing\)</span> and <span class="math inline">\(IceCreamEating\)</span> are related. Why?</li>
<li>Maybe, we theorize, that wearing shorts causes you to eat ice cream ( <span class="math inline">\(ShortsWearing \rightarrow IceCreamEating\)</span> )</li>
<li>However, there‚Äôs another explanation/path: <span class="math inline">\(Temperature\)</span> causes both ( <span class="math inline">\(ShortsWearing \leftarrow Temperature \rightarrow IceCreamEating\)</span> )</li>
<li>We need to control for temperature to <em>close this path!</em></li>
<li>Once it‚Äôs closed, the only path left is <span class="math inline">\(ShortsWearing \rightarrow IceCreamEating\)</span>, so if we <em>do</em> see a relationship still in the data, we know we‚Äôve identified the causal effect</li>
</ul>
<hr>
</section>
<section id="detailing-paths" class="level1">
<h1>Detailing Paths</h1>
<ul>
<li>The goal is to list all the paths that go from the <em>cause</em> of our choice to the <em>outcome</em> variable (no loops)</li>
<li>That way we know what we need to control for to close the paths!</li>
<li>Control for any one variable on the path, and suddenly there‚Äôs no variation from that variable any more - the causal chain is broken and the path is closed!</li>
<li>A path counts no matter which direction the arrows point on it (the arrow direction matters but we‚Äôll get to that next time)</li>
<li>If the path isn‚Äôt part of what answers our research question, it‚Äôs a <em>back door</em> we want to be closed</li>
</ul>
<hr>
</section>
<section id="preschool-and-adult-earnings" class="level1">
<h1>Preschool and Adult Earnings</h1>
<p>Does going to preschool improve your earnings as an adult?</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="slides_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<hr>
</section>
<section id="paths" class="level1">
<h1>Paths</h1>
<ol type="1">
<li><span class="math inline">\(Preschool \rightarrow Earnings\)</span></li>
<li><span class="math inline">\(Preschool \rightarrow Skills \rightarrow Earnings\)</span></li>
<li><span class="math inline">\(Preschool \leftarrow Location \rightarrow Earnings\)</span></li>
<li><span class="math inline">\(Preschool \leftarrow Background \rightarrow Earnings\)</span></li>
<li><span class="math inline">\(Preschool \leftarrow Background \rightarrow Skills \rightarrow Earnings\)</span></li>
<li><span class="math inline">\(Preschool \rightarrow Skills \leftarrow Background \rightarrow Earnings\)</span></li>
</ol>
<hr>
</section>
<section id="closing-paths" class="level1">
<h1>Closing Paths</h1>
<ul>
<li>We want the ways that <span class="math inline">\(Preschool\)</span> causes <span class="math inline">\(Earnings\)</span> - that‚Äôs the first two, <span class="math inline">\(Preschool \rightarrow Earnings\)</span> and <span class="math inline">\(Preschool \rightarrow Skills \rightarrow Earnings\)</span></li>
<li>The rest we want to close! They‚Äôre <em>back doors</em></li>
<li><span class="math inline">\(Location\)</span> is on #3, so if we control for <span class="math inline">\(Location\)</span>, 3 is closed</li>
<li><span class="math inline">\(Background\)</span> is on the rest, so if we control for <span class="math inline">\(Background\)</span>, the rest are closed</li>
<li>So if we estimate the below OLS equation, <span class="math inline">\(\hat{\beta}_1\)</span> will be unbiased!</li>
</ul>
<p><span class="math display">\[Earnings = \beta_0 + \beta_1Preschool + \beta_2Location + \beta_3Background+\varepsilon\]</span></p>
<hr>
</section>
<section id="and-the-bad-news" class="level1">
<h1>And the Bad News‚Ä¶</h1>
<ul>
<li>This assumes that <em>the model we drew was accurate</em>. Did we leave any important variables or arrows out? Think hard!</li>
<li>What other variables might belong on this graph? Would they be on a path that gives an alternate explanation?</li>
<li>Just because we <em>say</em> that‚Äôs the model doesn‚Äôt magically make it the <em>actual model!</em> It needs to be right! Use that economic theory and common sense to think about missing parts of the graph</li>
<li>Also, <em>can</em> we control for those things? What would it mean to assign a single number for <span class="math inline">\(Background\)</span> to someone? Or if we‚Äôre representing <span class="math inline">\(Background\)</span> with multiple variables - race, gender, parental income, etc., how do we know if we‚Äôve fully covered it?</li>
</ul>
<hr>
</section>
<section id="and-the-bad-news-1" class="level1">
<h1>And the Bad News‚Ä¶</h1>
<ul>
<li>Regardless, this is the kind of thinking (whether or not you do that thinking <em>with a causal diagram</em>) we have to do to figure out how to identify things by controlling for variables</li>
<li>There‚Äôs no way to get around having to make these sorts of assumptions if we want to identify a causal effect</li>
<li>Really! No way at all! Even experiments have assumptions</li>
<li>The key is not avoiding assumptions, but making sure they‚Äôre reasonable, and verifying those assumptions where you can</li>
</ul>
<hr>
</section>
<section id="an-example" class="level1">
<h1>An Example</h1>
<ul>
<li>Let‚Äôs back off of those concerns a moment and generate the data ourselves so we know the truth!</li>
<li>In the below data generating process, what is the true effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span>?</li>
<li>Let‚Äôs figure out how to draw the causal diagram for this data generating process!</li>
<li>(note: <code>U1</code>, <code>U2</code>, etc., often stand in as an unobserved common cause for two variables that are <em>correlated</em> but we think neither causes the other)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>tib2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">U1 =</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>), <span class="at">A =</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>), <span class="at">B =</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">C =</span> U1 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>), <span class="at">D =</span> U1 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">X =</span> A <span class="sc">+</span> C <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Y =</span> <span class="dv">4</span><span class="sc">*</span>X <span class="sc">+</span> A <span class="sc">+</span> B <span class="sc">+</span> D <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>))</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">feols</span>(Y<span class="sc">~</span>X, <span class="at">data =</span> tib)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(m1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)           X 
   2.756197    3.420627 </code></pre>
</div>
</div>
<hr>
</section>
<section id="the-diagram" class="level1">
<h1>The Diagram</h1>
<ul>
<li>Here‚Äôs the diagram we can draw from that information. What paths are there from <code>X</code> to <code>Y</code>?</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<p><img src="slides_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<hr>
</section>
<section id="the-paths" class="level1">
<h1>The Paths</h1>
<ol type="1">
<li><span class="math inline">\(X \rightarrow Y\)</span></li>
<li><span class="math inline">\(X \leftarrow A \rightarrow Y\)</span></li>
<li><span class="math inline">\(X \leftarrow C \leftarrow U_1 \rightarrow D \rightarrow Y\)</span></li>
</ol>
<p>What do we <em>need</em> to control for to close all the paths we don‚Äôt want? Assume we can‚Äôt observe (and so can‚Äôt control for) <span class="math inline">\(U_1\)</span></p>
<hr>
</section>
<section id="the-adjusted-analysis" class="level1">
<h1>The Adjusted Analysis</h1>
<ul>
<li>Remember, the true <span class="math inline">\(\beta_1\)</span> was 4</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                               m1                 m2                 m3
Dependent Var.:                 Y                  Y                  Y
                                                                       
Constant        2.756*** (0.0461)   -0.0261 (0.0584)    0.0218 (0.0455)
X               3.421*** (0.0383)  4.004*** (0.0600)  4.003*** (0.0290)
A                                  1.044*** (0.0846) 0.9848*** (0.0549)
C                                 0.4827*** (0.0739)                   
D                                                    0.9827*** (0.0368)
_______________ _________________ __________________ __________________
S.E. type                     IID                IID                IID
Observations                1,000              1,000              1,000
R2                        0.88897            0.96089            0.97624
Adj. R2                   0.88886            0.96077            0.97617
---
Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<hr>
</section>
<section id="concept-checks-1" class="level1">
<h1>Concept Checks</h1>
<ul>
<li>Why did we only need to control for <span class="math inline">\(C\)</span> <em>or</em> <span class="math inline">\(D\)</span> in that last example?</li>
<li>Draw a graph with five variables on it: <span class="math inline">\(X\)</span>, <span class="math inline">\(Y\)</span>, <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, <span class="math inline">\(C\)</span>. Then draw arrows at them completely at random (except to ensure there‚Äôs no ‚Äúloop‚Äù where you can follow an arrow path from arrow base to head and end up where you started). Then list every path from <span class="math inline">\(X\)</span> to <span class="math inline">\(Y\)</span> and say what you‚Äôd need to control for to identify the effect</li>
<li>What would you need to control for to estimate the effect of ‚Äúdrinking a glass of wine a day‚Äù on ‚Äúlifespan‚Äù? Draw a diagram.</li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp("^(?:http:|https:)\/\/(?:lse-dsi\.github\.io\/|localhost)");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left"><img src="../../../figures/logos/MY_INSTITUTION.png" class="img-fluid"></div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">Copyright 2024, London School of Economics &amp; Political Science</div>
  </div>
</footer>



</body></html>